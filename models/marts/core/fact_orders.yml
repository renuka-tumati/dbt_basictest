version: 2

models:
  - name: fact_orders
    description: One record per Order
    columns:
      - name: payment_id
        description: Primary key
        tests:
          - not_null
          - unique
          - generic_test_pk_is_always_positive_number
          - relationships:
              to: ref('stg_payments')
              field: payment_id
      - name: amount
        description: amount for order
        tests:
          - average_dollars_spent_greater_than_one:         
              group_by_column: customer_id
      
          



